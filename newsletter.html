<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Suscr√≠bete a la newsletter</title>
  <style>
    :root{
      --bg:#ffffff;
      --text:#333333;
      --muted:#6b7280;
      --primary:#6c63ff;
      --primary-hover:#5952d4;
      --error:#ef4444;
      --radius:14px;
      --shadow:0 10px 30px rgba(0,0,0,.07);
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background:var(--bg);
    }
    .wrap{
      min-height:100dvh;
      display:grid;
      place-items:center;
      padding:32px 16px;
    }
    .card{
      width:100%;
      max-width:720px;
      background:#fff;
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:28px;
    }
    h1{
      margin:0 0 8px;
      font-size:clamp(24px, 3.2vw, 34px);
      letter-spacing:.2px;
    }
    p.lead{ color:var(--muted); margin:0 0 24px; }
    label{ display:block; font-weight:600; margin:14px 0 8px; }
    .req{ color:#999; font-weight:400; }
    input, textarea, button{
      width:100%;
      border:1px solid #e5e7eb;
      padding:14px 15px;
      border-radius:12px;
      font:inherit;
      outline:none;
      transition:.15s border-color ease;
      background:#fff;
    }
    input:focus, textarea:focus{ border-color:#c7cbff; }
    textarea{ min-height:110px; resize:vertical; }
    .err{ color:var(--error); font-size:14px; margin-top:6px; display:none; }
    .row{ display:grid; gap:14px; grid-template-columns:1fr; }
    @media (min-width:640px){ .row{ grid-template-columns:1fr 1fr; } }
    .actions{ margin-top:18px; display:flex; gap:12px; align-items:center; }
    .btn{
      background:var(--primary);
      color:#fff; border:none; cursor:pointer;
      font-weight:700;
      border-radius:12px;
      padding:14px 18px;
      transition:.15s background ease, .15s transform ease;
    }
    .btn:hover{ background:var(--primary-hover); transform:translateY(-1px); }
    .btn[disabled]{ opacity:.6; cursor:wait; transform:none; }
    .muted{ color:var(--muted); font-size:14px; }
    /* Modal de gracias */
    .modal{
      position:fixed; inset:0; display:none;
      place-items:center; background:rgba(0,0,0,.45); padding:20px;
    }
    .modal.on{ display:grid; }
    .modal .box{
      background:#0f172a; color:#e2e8f0; border-radius:16px;
      padding:26px 24px; max-width:520px; width:100%; text-align:center;
      box-shadow:0 20px 60px rgba(0,0,0,.35);
    }
    .modal h2{ margin:0 0 6px; }
    .modal p{ margin:0 0 18px; color:#cbd5e1; }
    .modal .ok{ background:#22c55e; color:#0b1220; border:none; padding:12px 18px; border-radius:12px; font-weight:700; cursor:pointer; }
  </style>
</head>
<body>
  <main class="wrap">
    <section class="card">
      <h1>Suscr√≠bete a la newsletter</h1>
      <p class="lead">Recibe ideas √∫tiles y casos reales sobre IA y SEO.</p>

      <form id="newsletter-form" novalidate>
        <div class="row">
          <div>
            <label for="name">Nombre <span class="req">*</span></label>
            <input id="name" name="name" type="text" placeholder="Tu nombre" autocomplete="given-name" />
            <div class="err" id="err-name">Escribe tu nombre.</div>
          </div>
          <div>
            <label for="email">Correo electr√≥nico <span class="req">*</span></label>
            <input id="email" name="email" type="email" placeholder="tucorreo@ejemplo.com" autocomplete="email" />
            <div class="err" id="err-email">Escribe un correo v√°lido.</div>
          </div>
        </div>

        <label for="question">¬øQu√© te gustar√≠a aprender sobre Inteligencia Artificial? <span class="req">*</span></label>
        <textarea id="question" name="question" placeholder="Tu respuesta"></textarea>
        <div class="err" id="err-question">Cu√©ntame al menos una frase.</div>

        <div class="actions">
          <button class="btn" id="btn" type="submit">Suscribirme</button>
          <span class="muted">* Campos obligatorios</span>
        </div>

        <div class="err" id="err-global" style="margin-top:10px;"></div>
      </form>
    </section>
  </main>


  <div class="modal" id="gracias">
    <div class="box">
      <h2>¬°Gracias por suscribirte! üéâ</h2>
      <p>Te llegar√° un correo de confirmaci√≥n si es necesario.</p>
      <button class="ok" id="close-thanks">Aceptar</button>
    </div>
  </div>

  <script>

    const WEBHOOK_URL = "https://hook.eu2.make.com/w2z37vvgbftj3dafuh7lepxvcji7mix0";

    const form  = document.getElementById('newsletter-form');
    const btn   = document.getElementById('btn');
    const modal = document.getElementById('thanks');
    const close = document.getElementById('close-thanks');

    const show = (el) => el.style.display = 'block';
    const hide = (el) => el.style.display = 'none';

    const setErr = (id, msg="") => {
      const el = document.getElementById(id);
      el.textContent = msg;
      if (msg) show(el); else hide(el);
    };

    const emailOk = (v) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);

    close.addEventListener('click', () => modal.classList.remove('on'));

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      setErr('err-global', "");
      setErr('err-name', "");
      setErr('err-email', "");
      setErr('err-question', "");

      const name     = form.name.value.trim();
      const email    = form.email.value.trim();
      const question = form.question.value.trim();

      // Validaci√≥n b√°sica
      let ok = true;
      if (name.length < 2)        { setErr('err-name', 'Escribe tu nombre.'); ok = false; }
      if (!emailOk(email))        { setErr('err-email', 'Escribe un correo v√°lido.'); ok = false; }
      if (question.length < 5)    { setErr('err-question', 'Cu√©ntame un poco m√°s.'); ok = false; }
      if (!ok) return;

      btn.disabled = true;

      try {
        // Env√≠o ‚Äúsimple‚Äù (sin headers) para evitar preflight/CORS
        await fetch(WEBHOOK_URL, {
          method: "POST",
          mode: "no-cors", // el navegador env√≠a la petici√≥n aunque no podamos leer la respuesta
          body: JSON.stringify({
            name,
            email,
            question,
            source: "newsletter-form",
            timestamp: new Date().toISOString()
          })
        });

        // Reset y gracias
        form.reset();
        modal.classList.add('on');

      } catch (err) {
        setErr('err-global', "No se pudo enviar. Int√©ntalo de nuevo en un momento.");
        console.error(err);
      } finally {
        btn.disabled = false;
      }
    });
  </script>
</body>
</html>
